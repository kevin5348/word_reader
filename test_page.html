<!DOCTYPE html>
<html>
<head>
    <title>Test Translation Page</title>
</head>
<body>
    <h1>Test Page for Word Translation</h1>
    <p>Hello world! This is a test.</p>
    <p>The difficult word should be translated.</p>
    
    <script>
        // Simulate the translation function
        function testTranslation() {
            const difficulties = {
                "hello": {
                    "difficulty_score": 0.2156835758323781,
                    "translation": "Hola"
                },
                "world": {
                    "difficulty_score": 0.3277809854937276,
                    "translation": "mundo"
                },
                "difficult": {
                    "difficulty_score": 0.3335429421429129,
                    "translation": "difícil"
                }
            };
            
            console.log("Starting translation test with:", difficulties);
            
            const walker = document.createTreeWalker(
                document.body,
                NodeFilter.SHOW_TEXT,
                null,
                false
            );

            const textNodes = [];
            let node;

            while ((node = walker.nextNode())) {
                textNodes.push(node);
            }

            console.log(`Found ${textNodes.length} text nodes`);

            textNodes.forEach(textNode => {
                let text = textNode.nodeValue;
                let originalText = text;

                console.log(`Processing: "${originalText}"`);

                Object.keys(difficulties).forEach(word => {
                    const translation = difficulties[word]?.translation || word;
                    const regex = new RegExp(`\\b${word}\\b`, 'gi');
                    
                    if (regex.test(originalText)) {
                        console.log(`Found "${word}" in text, replacing with "${translation}"`);
                        text = text.replace(regex, translation);
                    }
                });

                if (text !== originalText) {
                    console.log(`✅ REPLACING: "${originalText}" -> "${text}"`);
                    textNode.nodeValue = text;
                }
            });

            console.log("Translation test completed.");
        }
        
        // Run test after page loads
        window.addEventListener('load', testTranslation);
    </script>
</body>
</html>
